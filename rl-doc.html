<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>强化学习文档详情 - 我的博客</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo">
                    <h1>我的博客</h1>
                </div>
                <ul class="nav-menu">
                    <li><a href="index.html">首页</a></li>
                    <li><a href="reinforcement-learning.html" class="active">强化学习</a></li>
                    <li><a href="index.html#life">生活</a></li>
                    <li><a href="index.html#about">关于</a></li>
                </ul>
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </nav>

    <header class="doc-hero">
        <div class="container">
            <div class="doc-hero-content">
                <div class="doc-breadcrumb">
                    <a href="reinforcement-learning.html">强化学习专题</a>
                    <span> / </span>
                    <span id="doc-title-short">加载中...</span>
                </div>
                <h1 id="doc-title">正在加载...</h1>
                <p id="doc-description">请稍候，正在准备文档内容。</p>
                <div class="doc-meta">
                    <span id="doc-updated">更新时间：--</span>
                    <span id="doc-tags">标签：--</span>
                    <a id="doc-download" href="#" class="intro-link" download>下载 Markdown</a>
                </div>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <article id="doc-article" class="doc-article">
                <div id="doc-content" class="doc-content">
                    <p class="doc-loading">正在加载文档内容...</p>
                </div>
            </article>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>关于博客</h4>
                    <p>这是一个分享技术与生活的个人博客，记录学习历程，分享实践经验。</p>
                </div>
                <div class="footer-section">
                    <h4>快速链接</h4>
                    <ul>
                        <li><a href="index.html">首页</a></li>
                        <li><a href="index.html">文章归档</a></li>
                        <li><a href="index.html">标签云</a></li>
                        <li><a href="index.html">友情链接</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>分类</h4>
                    <ul>
                        <li><a href="index.html#tech">技术文章</a></li>
                        <li><a href="index.html#life">生活随笔</a></li>
                        <li><a href="index.html#life">读书笔记</a></li>
                        <li><a href="index.html#tech">项目分享</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>联系方式</h4>
                    <ul>
                        <li><a href="https://github.com/astor194" target="_blank">GitHub</a></li>
                        <li><a href="#">Twitter</a></li>
                        <li><a href="mailto:huzongxing0826@gmail.com">Email</a></li>
                        <li><a href="#">RSS订阅</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 我的博客. All rights reserved. | <a href="#">隐私政策</a> | <a href="#">使用条款</a></p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        const DOC_MAP = {
            "verl-ppo-startup": {
                title: "VERL PPO 启动流程完整报告",
                description: "完整梳理 VERL PPO 训练管线的启动流程与核心组件，为理解混合引擎与分布式调度提供全景视角。",
                updated: "2025-01-06",
                tags: ["VERL", "PPO", "Ray"],
                path: "VERL_PPO_启动流程完整报告.md"
            },
            "verl-rollout-flow": {
                title: "VERL Rollout 调用逻辑详解",
                description: "聚焦 Rollout Engine 的同步/异步实现、AgentLoop 架构与性能调优策略，帮助排查生成链路问题。",
                updated: "2025-01-06",
                tags: ["Rollout", "vLLM", "Async"],
                path: "VERL_Rollout调用逻辑详解.md"
            },
            "verl-role-interactions": {
                title: "VERL 角色交互分析报告",
                description: "拆解 Actor、Critic、RewardModel、RefPolicy 的职责边界与数据交互，配合时序图快速掌握整体训练节奏。",
                updated: "2025-01-06",
                tags: ["RLHF", "系统设计", "Ray"],
                path: "VERL_Role_Interaction_Report.md"
            }
        };

        function renderTags(tags = []) {
            if (!tags.length) return "标签：--";
            return `标签：${tags.join(" / ")}`;
        }

        function renderMermaid(container) {
            if (!window.mermaid) return;

            const codeBlocks = container.querySelectorAll('pre code.language-mermaid');
            if (!codeBlocks.length) return;

            codeBlocks.forEach(code => {
                const pre = code.parentElement;
                const wrapper = document.createElement('div');
                wrapper.className = 'mermaid';
                wrapper.textContent = code.textContent;
                pre.replaceWith(wrapper);
            });

            try {
                if (typeof mermaid.run === 'function') {
                    mermaid.run({ nodes: [container] });
                } else if (typeof mermaid.init === 'function') {
                    mermaid.init(undefined, container.querySelectorAll('.mermaid'));
                }
            } catch (error) {
                console.warn('Mermaid 渲染失败：', error);
            }
        }

        async function loadDocument(meta) {
            const docContent = document.getElementById("doc-content");
            docContent.innerHTML = '<p class="doc-loading">正在加载文档内容...</p>';

            try {
                const response = await fetch(meta.path);
                if (!response.ok) {
                    throw new Error(`网络请求失败：${response.status}`);
                }
                const markdown = await response.text();
                docContent.innerHTML = marked.parse(markdown, { mangle: false, headerIds: false });
                renderMermaid(docContent);
            } catch (error) {
                docContent.innerHTML = `<div class="doc-error">文档加载失败：${error.message}</div>`;
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            const params = new URLSearchParams(window.location.search);
            const slug = params.get("doc");
            const meta = DOC_MAP[slug];

            const titleEl = document.getElementById("doc-title");
            const titleShortEl = document.getElementById("doc-title-short");
            const descEl = document.getElementById("doc-description");
            const updatedEl = document.getElementById("doc-updated");
            const tagsEl = document.getElementById("doc-tags");
            const downloadEl = document.getElementById("doc-download");

            if (window.mermaid) {
                mermaid.initialize({ startOnLoad: false, theme: 'neutral' });
            }

            if (!meta) {
                titleEl.textContent = "未找到对应的文档";
                titleShortEl.textContent = "文档缺失";
                descEl.textContent = "请返回强化学习专题页面，选择已有的报告入口。";
                updatedEl.textContent = "更新时间：--";
                tagsEl.textContent = "标签：--";
                downloadEl.classList.add("hidden");
                document.getElementById("doc-content").innerHTML = '<div class="doc-error">无法解析文档标识，请确认链接是否正确。</div>';
                return;
            }

            titleEl.textContent = meta.title;
            titleShortEl.textContent = meta.title;
            descEl.textContent = meta.description;
            updatedEl.textContent = `更新时间：${meta.updated}`;
            tagsEl.textContent = renderTags(meta.tags);
            downloadEl.href = meta.path;
            downloadEl.classList.remove("hidden");

            loadDocument(meta);
        });
    </script>
    <script src="script.js"></script>
</body>
</html>

